<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Step-by-Step Guide to add a new KRI • gsm.kri</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Step-by-Step Guide to add a new KRI">
<meta name="description" content="This vignette outlines the necessary analytics tasks required before a new Key Risk Indicator (KRI), Quality Tolerance Limit (QTL), or similar metric can be put into production.">
<meta property="og:description" content="This vignette outlines the necessary analytics tasks required before a new Key Risk Indicator (KRI), Quality Tolerance Limit (QTL), or similar metric can be put into production.">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsm.kri</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/AddingKRIs.html">Step-by-Step Guide to add a new KRI</a></li>
    <li><a class="dropdown-item" href="../articles/SiteRiskScore.html">Calculating Site Risk Scores</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-examples" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Examples</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-examples">
<li><a class="dropdown-item" href="../examples/Example_SiteReport.html">Site KRI Report</a></li>
    <li><a class="dropdown-item" href="../examples/Example_CountryReport.html">Country KRI Report</a></li>
    <li><a class="dropdown-item" href="../examples/Example_Eligibility.html">Eligibility Report</a></li>
    <li><a class="dropdown-item" href="../examples/Cookbook_AdverseEventKRI.html">Cookbook - Adverse Event KRI Report</a></li>
    <li><a class="dropdown-item" href="../examples/Cookbook_AdverseEventWorkflow.html">Cookbook - Adverse Event Workflow Examples</a></li>
    <li><a class="dropdown-item" href="../examples/Cookbook_ReportingWorkflow.html">Cookbook - Reporting Workflow Examples</a></li>
    <li><a class="dropdown-item" href="../examples/Example_CrossStudySRS.html">Cross-Study KRI Report</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gilead-biostats/gsm.kri"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Step-by-Step Guide to add a new KRI</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/gsm.kri/blob/fix-185/vignettes/AddingKRIs.Rmd" class="external-link"><code>vignettes/AddingKRIs.Rmd</code></a></small>
      <div class="d-none name"><code>AddingKRIs.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette outlines the necessary analytics tasks required before
a new Key Risk Indicator (KRI), Quality Tolerance Limit (QTL), or
similar metric can be put into production. Once a subject-level data
listing is received from the source system and incorporated into our
monthly snapshots, a structured workflow ensures seamless integration of
the new metric. This process includes updates to the GSM data model,
creation of a KRI workflow, qualification testing, and incorporation
into reporting outputs. By following these steps, we maintain data
integrity, ensure metric accuracy, and support risk signal generation
and reporting functionalities.</p>
</div>
<div class="section level2">
<h2 id="adding-a-new-kri-step-by-step">Adding a new KRI Step-by-Step<a class="anchor" aria-label="anchor" href="#adding-a-new-kri-step-by-step"></a>
</h2>
<p>Once a subject level data listing is provided from a source system
and those tables have been added to our monthly snapshots, we have the
following analytics tasks to complete before a new metric (KRI/QTL, etc)
can be put in to production.</p>
<ol style="list-style-type: decimal">
<li>Make needed updates to gsm data model</li>
<li>Create a KRI workflow</li>
<li>Add qualification test(s) ensuring that the metric is behaving as
expected for test data.<br>
</li>
<li>Steps to incorporate metric into optional reporting outputs
<ul>
<li>Add new metrics to apps/reports</li>
<li>Generate Risk signals for <code>{grail}</code>
</li>
<li>Update existing Study scripts to add the metrics</li>
</ul>
</li>
</ol>
<p>Below we get into more detail for each of these steps</p>
<div class="section level3">
<h3 id="make-updates-to-the-gsm-data-model">Make updates to the gsm data model<a class="anchor" aria-label="anchor" href="#make-updates-to-the-gsm-data-model"></a>
</h3>
<p>For each KRI, there will be data requirements that need to be
specified as the first step to incorporating the KRI into a final
report. The first step in this process is to ensure that the data is
programmatically available to be pulled down from a centralized data
store. Once this is confirmed, an issue is to be filed in
<a href="https://github.com/Gilead-BioStats/gsm.mapping" class="external-link">gsm.mapping</a> repo using the <code>Add New Domain</code>
issue template and filling in the relevant information.</p>
<p>With the issue filed, and the requirements laid out, a specification
mapping file is created that indicates the name of each data source, and
all required fields from each respective data source along with their
data types. An example of this specification yaml file is below. More
details about the construction of these files can be found in
<a href="https://github.com/Gilead-BioStats/gsm.mapping" class="external-link">gsm.mapping</a> package documentation.</p>
<pre><code>meta:
  Type: Mapped
  ID: PD
  Description: Protocol Deviation Data Mapping 
  Priority: 1
spec: 
  Raw_PD:
    subjid:
      type: character
      source_col: subjectenrollmentnumber
    deemedimportant:
      type: character
steps:
  - output: Mapped_PD
    name: =
    params:
      lhs: Mapped_PD
      rhs: Raw_PD</code></pre>
<p>It is possible that some of the domains that are needed for a given
KRI may already be mapped in <a href="https://github.com/Gilead-BioStats/gsm.mapping" class="external-link">gsm.mapping</a>. In this case,
check the existing spec for that domain for all relevant fields, and if
any are missing, create an issue to
<code>Request New Domain or Variable</code>, and fill in all fields.
Once the edits have been made following the <a href="https://gilead-biostats.github.io/gsm.core/articles/ContributorGuidelines.html" class="external-link">Contributor
Guidelines</a>, submit a Pull Request to merge in the edits required for
adding this new KRI.</p>
<p>Add support for new tables in <code>gsm.datasim</code> for use in the
gismo test environment.</p>
</div>
<div class="section level3">
<h3 id="creating-a-kri-workflow">Creating a KRI Workflow<a class="anchor" aria-label="anchor" href="#creating-a-kri-workflow"></a>
</h3>
<p>To implement a new Key Risk Indicator (KRI) within the system, we
must establish workflows and update several existing analytical
functions to align with the new requirements. This process ensures that
the new KRI is accurately integrated into our analytics framework and
reporting structure. A more in depth discussion of the Analytics
pipeline is outlined in this <a href="https://gilead-biostats.github.io/gsm.core/articles/DataAnalysis.html" class="external-link">vignette</a></p>
<div class="section level4">
<h4 id="creating-and-customizing-yaml-workflow-files">Creating and Customizing YAML Workflow Files<a class="anchor" aria-label="anchor" href="#creating-and-customizing-yaml-workflow-files"></a>
</h4>
<p>The first step is to create or modify YAML workflow files that define
the new KRI. These files include:</p>
<ul>
<li>
<strong>Metric Metadata:</strong> Define key details such as the
metric’s description, numerator, denominator, and other relevant
specifications. Each KRI must have a unique identifier that follows the
existing naming convention (e.g., <code>kri0013</code> for
<a href="https://github.com/Gilead-BioStats/gsm.kri" class="external-link">gsm.kri</a> or <code>kri0002ep</code> for
<code>{gsm.endpoints}</code>).</li>
<li>
<strong>Metric Data Specification:</strong> Ensure the data
specifications align with updates made to the data model. This step
guarantees consistency in data interpretation and calculation.</li>
<li>
<strong>Metric Workflow Definition:</strong> Specify the functions
and parameters required to calculate the metric. This typically follows
the standard <a href="https://gilead-biostats.github.io/gsm.core" class="external-link">gsm.core</a> <a href="https://gilead-biostats.github.io/gsm.core/articles/DataAnalysis.html" class="external-link">analysis
workflow</a>, ensuring consistency with existing metrics.</li>
</ul>
</div>
<div class="section level4">
<h4 id="creating-country-level-workflows-if-applicable">Creating Country-Level Workflows (If Applicable)<a class="anchor" aria-label="anchor" href="#creating-country-level-workflows-if-applicable"></a>
</h4>
<p>If country-level metrics are needed, parallel workflows must be
created within the <a href="https://github.com/Gilead-BioStats/gsm.kri" class="external-link">gsm.kri</a> package. These workflows allow
for localized risk assessment and reporting, providing granularity in
data analysis.</p>
</div>
<div class="section level4">
<h4 id="updating-core-analytical-functions">Updating Core Analytical Functions<a class="anchor" aria-label="anchor" href="#updating-core-analytical-functions"></a>
</h4>
<p>The next step involves updating <a href="https://gilead-biostats.github.io/gsm.core" class="external-link">gsm.core</a> analytics
functions to ensure they can accurately compute the new KRI. This may
include modifying existing logic, incorporating additional parameters,
or adjusting calculations to reflect the new metric’s requirements. This
step may not be necessary for every new metric.</p>
</div>
<div class="section level4">
<h4 id="enhancing-visualization-and-reporting-functionality">Enhancing Visualization and Reporting Functionality<a class="anchor" aria-label="anchor" href="#enhancing-visualization-and-reporting-functionality"></a>
</h4>
<p>Finally, any necessary updates should be made to the
<a href="https://github.com/Gilead-BioStats/gsm.kri" class="external-link">gsm.kri</a> and <code>{rbm-viz}</code> packages to support
visualization and widget functionality. This ensures that the new KRI is
correctly represented in dashboards and reports, providing clear and
actionable insights for stakeholders. This step may not be necessary for
every new metric.</p>
<p>By following these steps, we ensure that the new metric is seamlessly
integrated into our analytics framework, maintaining consistency,
accuracy, and usability across the system.</p>
</div>
<div class="section level4">
<h4 id="add-qualification-tests">Add qualification test(s)<a class="anchor" aria-label="anchor" href="#add-qualification-tests"></a>
</h4>
<p>To ensure that the metric is behaving as expected for test data, a
new test or multiple tests must be written and documented in the
<code>{gsm.qc}</code> package. <code>{gsm.qc}</code> uses the
<code>{qcthat}</code> framework, which is detailed in the package
documentation <a href="https://gilead-biostats.github.io/qcthat/" class="external-link">here</a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="steps-to-incorporate-a-metric-into-reporting-outputs">Steps to Incorporate a Metric into Reporting Outputs<a class="anchor" aria-label="anchor" href="#steps-to-incorporate-a-metric-into-reporting-outputs"></a>
</h3>
<p>Once the new Key Risk Indicator (KRI) has been integrated into the
analytics framework, it must be incorporated into reporting outputs to
ensure visibility and usability. This process involves updating existing
reports or creating new ones and integrating the metric into the
application specified in <code>{gsm.app}</code>.</p>
<div class="section level4">
<h4 id="adding-new-metrics-to-reports">Adding New Metric(s) to Reports<a class="anchor" aria-label="anchor" href="#adding-new-metrics-to-reports"></a>
</h4>
<ul>
<li>
<strong>Integrate into Existing Reports:</strong> If the new metric
aligns with the structure of current KRI reports, add it to the
appropriate reports to maintain consistency in analysis and
visualization.</li>
<li>
<strong>Create a New Report (If Needed):</strong> If the new metric
requires unique data representation or analysis, develop a standalone
report tailored to its specifications. This ensures that the metric is
properly contextualized for stakeholders.</li>
</ul>
</div>
<div class="section level4">
<h4 id="updating-the-application-for-metric-integration">Updating the Application for Metric Integration<a class="anchor" aria-label="anchor" href="#updating-the-application-for-metric-integration"></a>
</h4>
<ul>
<li>
<strong>Add the Metric to {gsm.app}:</strong> If the metric follows
standard KRI functionality, integrate it into the existing application
as a standard KRI. This ensures that it is accessible and consistent
with other KRIs.</li>
<li>
<strong>Develop a New Module (If Required):</strong> If the metric
requires specialized functionality beyond the existing KRI framework,
create a new module within {gsm.app} to support its unique requirements.
This may involve custom visualizations, interactions, or calculations
specific to the new metric.</li>
</ul>
</div>
<div class="section level4">
<h4 id="generate-risk-signals-for-ado">Generate Risk signals for ADO<a class="anchor" aria-label="anchor" href="#generate-risk-signals-for-ado"></a>
</h4>
<p>In order to incorporate this metric into the ticketing system used by
the risk advisers to address flagged sites or participants,
<code>{grail}</code> must be updated to add default actions for risk
signals produced by this metric.</p>
</div>
<div class="section level4">
<h4 id="update-study-scripts-to-add-the-metrics">Update Study scripts to add the metrics<a class="anchor" aria-label="anchor" href="#update-study-scripts-to-add-the-metrics"></a>
</h4>
<p>To ensure that the new Key Risk Indicator (KRI) is correctly
integrated into ongoing studies, we must update existing study scripts.
These scripts are responsible for processing study-level data,
generating risk signals, and ensuring that the new metric is included in
all relevant analyses.</p>
<p>Review the current study scripts to determine which ones require
modifications to accommodate the new metric. Identify any dependencies
or interactions between the new metric and existing KRIs, ensuring that
all calculations remain consistent, and the Priority tag in the
<code>meta</code> yamls are appropriately assigned.</p>
<p>By following these steps, we ensure that the new KRI is effectively
incorporated into reporting modules and applications, enabling the study
team to monitor and evaluate the metric for a given study.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeremy Wildfire, Laura Maxwell, Spencer Childress.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
